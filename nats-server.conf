# NATS Server Configuration for Azure Deployment
# Basic security configuration for on-prem to Azure communication

# Server listening configuration
port: 4222
http_port: 8222

# Server name
server_name: "azure-nats-server"

# Enable monitoring endpoint
monitor_port: 8222

# Logging
debug: false
trace: false
logtime: true

# Authorization (Basic Security)
authorization {
    # Define users with passwords
    users = [
        {
            user: "azure_client"
            password: "AzureClient@2025"
            permissions: {
                publish: ">"
                subscribe: ">"
            }
        }
        {
            user: "onprem_device"
            password: "OnPremDevice@2025"
            permissions: {
                publish: "devices.>"
                subscribe: ["commands.>", "config.>"]
            }
        }
        {
            user: "admin"
            password: "Admin@2025"
            permissions: {
                publish: ">"
                subscribe: ">"
            }
        }
    ]
}

# Limits
max_connections: 1000
max_payload: 1048576  # 1MB
max_pending: 67108864 # 64MB

# Cluster configuration (for future scaling)
# cluster {
#     name: azure-cluster
#     listen: 0.0.0.0:6222
# }

# JetStream (for persistence - optional)
jetstream {
    store_dir: "/data/jetstream"
    max_memory_store: 1073741824  # 1GB
    max_file_store: 10737418240   # 10GB
}
